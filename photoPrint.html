<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RT Photos Printing</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="pBody">
        <div class="header">
            <h1>Photos Printer</h1>
            <i></i>
        </div>
        <div class="pContent">
            <div class="leftSection">
                <ul class="receivedForms layouts">
                    <h2>Layouts</h2>
                    <li id="PPS" class="active" value="1" onclick="accessFeaturePPS()">Passport Size Photos</li>
                    <li id="IDC" class="" value="2" onclick="accessFeatureIDC()">ID Cards</li>
                </ul>

                <ul class="receivedForms Status">
                    <h2 id="statusHead">Status</h2>
                    <li id="photoCounter">Total Photos : 0</li>
                    <li id="sheetCounter">Total Sheets : 0</li>
                </ul>
            </div>

            <div class="middleSection">
                <input type="file" id="imageInput" accept="image/*" onchange="handleImageUpload()">
                <img id="previewImage" src="#" alt="Preview Image">
                <input type="number" id="noOfPics" placeholder="Enter No. Of Photos" value="8">
                <button onclick="passportSizePhotos()" id="layoutBtn" class="button">Preview</button>
                <button onclick="removePhotos()" id="layoutBtn" class="button negative">Clear</button>
            </div>

            <div class="rightSection">
                <h4>Preview</h4>
                <div class="Preview">
                    <div class="PreviewPage">

                    </div>
                </div>
                <button onclick="printPhotos()">Print</button>
            </div>

        </div>
    </div>

    <div class="printWindow">

    </div>
    <script>

        let inputSection = document.getElementById("inputSection");
        let layoutBtn = document.getElementById("layoutBtn");
        let pBody = document.querySelector("#pBody");
        let noOfPics = document.querySelector("#noOfPics");
        let imageInput = document.querySelector("#imageInput");
        let previewImage = document.querySelector("#previewImage");

        let PreviewPage = document.querySelector(".PreviewPage");
        let printWindow = document.querySelector(".printWindow");

        let Status = document.querySelector(".Status");

        let photoCounter = document.querySelector("#photoCounter");
        let sheetCounter = document.querySelector("#sheetCounter");

        let PPS = document.querySelector("#PPS");
        let IDC = document.querySelector("#IDC");

        let imageSrc;
        let imageCount = 0;
        let sheetCount = 1;
        let printMode = 1;

        // Function to handle the file input change event
        function handleImageUpload() {
            const input = document.getElementById('imageInput');
            const preview = document.getElementById('previewImage');

            const file = input.files[0];

            if (file) {
                const reader = new FileReader();

                reader.onload = function (e) {
                    preview.src = e.target.result;
                    imageSrc = e.target.result;
                    // preview.style.display = "block";
                };

                reader.readAsDataURL(file);

            }
            previewImage.style.display = "block";

        }

        function passportSizePhotos() {

            for (let i = 0; i < noOfPics.value; i++) {
                let image = document.createElement("img")
                image.src = imageSrc;
                if (printMode == 1) {
                    image.style.height = "2.5cm";
                    image.style.width = "2cm";
                } else if (printMode == 2) {
                    image.style.height = "3cm";
                    image.style.width = "5cm";
                }
                image.style.marginLeft = "10px";
                image.style.marginTop = "10px";

                PreviewPage.appendChild(image);

                let image2 = document.createElement("img")
                image2.src = imageSrc;
                image2.style.marginLeft = "20px";
                image2.style.marginTop = "20px";
                if (printMode == 1) {
                    image2.style.height = "4.5cm";
                    image2.style.width = "3.5cm";
                } else if (printMode == 2) {
                    image2.style.height = "5.4cm";
                    image2.style.width = "8.5cm";
                }
                image2.style.border = "solid 1px black";

                printWindow.appendChild(image2);

            }

            printWindow.style.display = "none";
            imageCount += parseInt(noOfPics.value);

            photoCounter.innerHTML = "Total Photos : " + imageCount;

            if (printMode == 1) {
                if (imageCount <= 20) {
                    sheetCount = 1;
                } else if (imageCount <= 40) {
                    sheetCount = 2;
                }
                else if (imageCount <= 60) {
                    sheetCount = 3;
                }
                else if (imageCount <= 80) {
                    sheetCount = 4;
                }
                else if (imageCount <= 100) {
                    sheetCount = 5;
                } else {
                    sheetCount = imageCount / 20;
                }
            } else if (printMode == 2) {
                if (imageCount <= 8) {
                    sheetCount = 1;
                } else if (imageCount <= 16) {
                    sheetCount = 2;
                }
                else if (imageCount <= 24) {
                    sheetCount = 3;
                }
                else if (imageCount <= 32) {
                    sheetCount = 4;
                }
                else if (imageCount <= 40) {
                    sheetCount = 5;
                } else {
                    sheetCount = imageCount / 8;
                }
            }

            sheetCounter.innerHTML = "Total Sheets : " + sheetCount;

        }

        function printPhotos() {
            document.body.style.backgroundColor = "white";
            pBody.style.display = "none";
            printWindow.style.display = "block";
            window.print();
        }

        function removePhotos() {
            location.reload();
        }

        function accessFeaturePPS() {
            PPS.classList.add("active");
            IDC.classList.remove("active");
            noOfPics.value = "8";
            printMode = 1;

            printWindow.innerHTML = "";
            PreviewPage.innerHTML = "";
            previewImage.style.display = "none";
            imageInput.value = "";

            previewImage.style.height = "4.5cm";
            previewImage.style.width = "3.5cm";
            
        }
        function accessFeatureIDC() {
            PPS.classList.remove("active");
            IDC.classList.add("active");
            noOfPics.value = "1";
            printMode = 2;

            printWindow.innerHTML = "";
            PreviewPage.innerHTML = "";
            previewImage.style.display = "none";
            imageInput.value = "";

            previewImage.style.height = "5cm";
            previewImage.style.width = "9cm";
        }
    

        previewImage.style.display = "none";
        accessFeaturePPS();

    </script>
</body>

</html>
